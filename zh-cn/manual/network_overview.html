<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>网络模块 | NULS</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://nuls-io.github.io/zh-cn/manual/network_overview.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://nuls-io.github.io/manual/network_overview.html">
    
      <link rel="alternative" hreflang="zh-cn" href="https://nuls-io.github.io/zh-cn/manual/network_overview.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="generator" content="Hexo 3.8.0">
  <!-- CSS -->
  <!-- build:css build/css/nuls.css -->
  <link rel="stylesheet" href="/css/nuls.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="NULS">
</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/zh-cn/" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="/zh-cn/docs/" class="main-nav-link">文档</a><a href="/zh-cn/protocol/" class="main-nav-link">协议</a><a href="/zh-cn/contract/" class="main-nav-link">智能合约</a><a href="/zh-cn/chain/" class="main-nav-link">跨链</a><a href="/zh-cn/manual/" class="main-nav-link">参考手册</a><a href="/news/" class="main-nav-link">新闻</a>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></label>
      <select id="lang-select" data-canonical="manual/network_overview.html">
        
          <option value="en">English</option>
        
          <option value="zh-cn" selected>简体中文</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope="" itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">网络模块</h1>
                <a href="https://github.com/nuls-io/devsite/edit/master/source/zh-cn/manual/network_overview.md" class="article-edit-link" title="改进本文"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h2 id="模块概述" class="article-heading"><a href="#模块概述" class="headerlink" title="模块概述"></a>模块概述<a class="article-anchor" href="#模块概述" aria-hidden="true"></a></h2><p>​        网络模块为NULS八大基础模块之一，提供最底层的网络通信、节点发现等服务。区块链的网络基础就是Peer to Peer,即P2P。P2P网络中的所有参与者，可以是提供服务（server），也可以是资源使用者（client）。P2P网络的特点：非中心化、可扩展性、健壮性、高性价比、隐私保护、负载均衡。</p>
<p>根据结构关系可以将P2P系统细分为四种拓扑形式：</p>
<ul>
<li><p>中心化拓扑（Centralized Topology）：即存在一个中心节点保存了其他所有节点的索引信息，索引信息一般包括节点 IP 地址、端口、节点资源等；</p>
<p><img src="network/p2p-t1.png" alt=""></p>
</li>
<li><p>全分布式非结构化拓扑（Decentralized Unstructured Topology）：移除了中心节点，在 P2P 节点之间建立随机网络，就是在一个新加入节点和 P2P 网络中的某个节点间随机建立连接通道，从而形成一个随机拓扑结构。比特币采用的是该网络结构；</p>
<p><img src="network/p2p-t2.png" alt=""></p>
</li>
<li><p>全分布式结构化拓扑（Decentralized Structured Topology，也称作DHT网络）：将所有节点按照某种结构进行有序组织，比如形成一个环状网络或树状网络。而结构化网络的具体实现上，普遍都是基于 DHT(Distributed Hash Table，分布式哈希表) 算法思想。比如以太坊网络的实现算法Kademlia；</p>
<p><img src="network/p2p-t3.png" alt=""></p>
</li>
<li><p>半分布式拓扑（Partially Decentralized Topology）：吸取了中心化结构和全分布式非结构化拓扑的优点，选择性能较高（处理、存储、带宽等方面性能）的结点作为超级结点（英文表达为SuperNodes或者Hubs），在各个超级结点上存储了系统中其他部分结点的信息，发现算法仅在超级结点之间转发，超级结点再将查询请求转发给适当的叶子结点。半分布式结构也是一个层次式结构，超级结点之间构成一个高速转发层，超级结点和所负责的普通结点构成若干层次。EOS采用的就是该网络结构。</p>
<p><img src="network/p2p-t4.png" alt=""></p>
</li>
</ul>
<p>​        NULS1.0版本类似于比特币采用的是第二种，全分布式非结构化拓扑。网络中的节点具有功能有：路由、钱包、挖矿、区块链数据库。所有的节点都具有路由功能，参与校验和广播交易及区块信息，且会发现和维持与其他节点的连接。</p>
<p><strong>模块信息</strong><br>​<br>​    模块名称：network-module<br>​<br>​    模块结构：模块顶级目录network-module，consesnus工程为模块接口定义，base目录下为网络模块的默认实现，实现工程network-base，network-protocol实现相关网络协议，network-storage网络存储接口和实现。<br>​<br>​    接口定义依赖模块：<strong>protocol-module、network-module</strong><br>​<br>​    实现额外依赖模块：<strong>core-module、ledger-module、account-module、account-ledger-module</strong></p>
<h2 id="二-模块功能" class="article-heading"><a href="#二-模块功能" class="headerlink" title="二 模块功能"></a>二 模块功能<a class="article-anchor" href="#二-模块功能" aria-hidden="true"></a></h2><p>本小节会详细描述网络模块的功能需求和每一个功能点限制条件，以及NULS1.0版本的默认实现方式。</p>
<h3 id="1-节点发现" class="article-heading"><a href="#1-节点发现" class="headerlink" title="1.节点发现"></a>1.节点发现<a class="article-anchor" href="#1-节点发现" aria-hidden="true"></a></h3><p>​    功能需求：NULS的每一个节点既是服务器，可接受其他节点的连接；同时也是客户端，会主动向其他节点发起连接。节点之间会相互询问更多的节点，并尝试连接，每个节点都尽量保证自己连接到更多的节点且相互通信。</p>
<p>​    实现方式：NULS1.0版本默认采用Netty框架实现。运行节点时，网络模块会启动网络服务(NettySever)，等待其他节点的连接，同时也会主动连接其他节点(NettyClient)。主动连接的节点，我们称为主动节点，同一IP地址不能重复发起主动连接；网络服务接收到的新节点，我们称为被动节点，考虑到有局域网内节点对外暴露的公网IP一致，因此被动节点运行统一IP地址最多有10个连接。</p>
<p>​    主动节点连接成功后，对方会返回更多其他可连接节点信息，收到节点信息后，再依次尝试主动连接这些节点。直到达到配置的主动连接最大值为止。</p>
<p>​    NULS1.0版本提供了7个种子节点，有新节点第一次运行时会连接7个种子节点。种子节点会返回新节点的外网IP地址，新节点会尝试通过外网IP主动连接自己的服务器，如果连接成功，则会主动发送一条新节点消息到网络中，其他节点收到消息后，会尝试连接新节点。</p>
<h3 id="2-消息接收与处理" class="article-heading"><a href="#2-消息接收与处理" class="headerlink" title="2.消息接收与处理"></a>2.消息接收与处理<a class="article-anchor" href="#2-消息接收与处理" aria-hidden="true"></a></h3><p>​    功能需求：节点会收到其他节点的发送的消息。收到的消息首先通过NULS的网络协议过滤，过滤后的消息再交由各个模块处理。</p>
<p>​    实现方式：NULS所发送的消息包含消息头(MessageHeader)和消息体(MessageBody)，消息头内包含魔法参数，消息对应的模块ID和消息类型。在接收到其他节点发送的消息后，首先判断魔法参数是否一致，再判断模块ID和消息类型是否存在，不一致的消息直接过滤。</p>
<p>​    过滤后的消息，有网络模块的协议，则由网络模块自己处理。非网络模块协议，统一放到分发器里，由分发器分发给其他模块，通过自定义的反序列化方法将MessageBody转换成业务数据再做相应处理。</p>
<h3 id="3-消息广播" class="article-heading"><a href="#3-消息广播" class="headerlink" title="3.消息广播"></a>3.消息广播<a class="article-anchor" href="#3-消息广播" aria-hidden="true"></a></h3><p>​    功能需求：由节点产生的协议（区块、交易等）会通过网络模块发送到已连接并握手成功的其他节点。</p>
<p>​    实现方式：网络模块提供了广播消息的接口，接口会将所有消息都添加上对应模块的消息头，再通过自定义的序列化方法转换成网络信息，发送到其他节点。</p>
<h3 id="4-节点分组" class="article-heading"><a href="#4-节点分组" class="headerlink" title="4.节点分组"></a>4.节点分组<a class="article-anchor" href="#4-节点分组" aria-hidden="true"></a></h3><p>​    功能需求：已连接的对等节点，可根据不同的属性与功能，存放在不同的节点组里方便管理。例如按照连接情况分为主动连接组、被动连接组、按照功能可分为共识节点组、普通节点组。</p>
<p>​    实现方式：网络模块提供了节点分组功能，并提供了创建节点组、添加节点到节点组、获取节点组等接口。当前网络模块默认创建了主动连接组和被动连接组。</p>
<h2 id="三-模块接口" class="article-heading"><a href="#三-模块接口" class="headerlink" title="三 模块接口"></a>三 模块接口<a class="article-anchor" href="#三-模块接口" aria-hidden="true"></a></h2><p>网络模块的外部接口定义类为io.nuls.network.service.NetworkService</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line">* 断开一个已连接的节点</span><br><span class="line">* Disconnect the connection with the node</span><br><span class="line">*</span><br><span class="line">* @param nodeId the id of node</span><br><span class="line">*/</span><br><span class="line">void removeNode(String nodeId);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 获取一个节点</span><br><span class="line">* get node by id</span><br><span class="line">*</span><br><span class="line">* @param nodeId the id of node</span><br><span class="line">* @return Node</span><br><span class="line">*/</span><br><span class="line">Node getNode(String nodeId);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 获取所有节点</span><br><span class="line">* get all nodes</span><br><span class="line">*</span><br><span class="line">* @return Map</span><br><span class="line">*/</span><br><span class="line">Map&lt;String, Node&gt; getNodes();</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 获取已连接的节点</span><br><span class="line">* get connected nodes</span><br><span class="line">*</span><br><span class="line">* @return Collection</span><br><span class="line">*/</span><br><span class="line">Collection&lt;Node&gt; getAvailableNodes();</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 获取可连接的节点</span><br><span class="line">* get connectable nodes</span><br><span class="line">*</span><br><span class="line">* @return List</span><br><span class="line">*/</span><br><span class="line">List&lt;Node&gt; getCanConnectNodes();</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 根据名字获取节点组</span><br><span class="line">* get NodeGroup by name</span><br><span class="line">*</span><br><span class="line">* @param  groupName groupName</span><br><span class="line">* @return NodeGroup</span><br><span class="line">*/</span><br><span class="line">NodeGroup getNodeGroup(String groupName);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 发送消息</span><br><span class="line">* Send message to all connected nodes</span><br><span class="line">*</span><br><span class="line">* @param nulsData message</span><br><span class="line">* @param asyn     Whether or not asynchronous</span><br><span class="line">* @return BroadcastResult</span><br><span class="line">*/</span><br><span class="line">BroadcastResult sendToAllNode(BaseNulsData nulsData, boolean asyn, int percent);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 发送消息</span><br><span class="line">* Send message to all connected nodes</span><br><span class="line">*</span><br><span class="line">* @param event event</span><br><span class="line">* @param excludeNode node that does not need to be send</span><br><span class="line">* @param asyn Whether or not asynchronous</span><br><span class="line">* @param percent percent of nodes count</span><br><span class="line">* @return BroadcastResult</span><br><span class="line">*/</span><br><span class="line">BroadcastResult sendToAllNode(BaseNulsData event, Node excludeNode, boolean asyn, int percent);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* send message to node</span><br><span class="line">*</span><br><span class="line">* @param event event</span><br><span class="line">* @param node node</span><br><span class="line">* @param asyn  Whether or not asynchronous</span><br><span class="line">* @return BroadcastResult</span><br><span class="line">*/</span><br><span class="line">BroadcastResult sendToNode(BaseNulsData event, Node node, boolean asyn);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 发送消息给节点组</span><br><span class="line">* send message to nodeGroup</span><br><span class="line">*</span><br><span class="line">* @param  event event</span><br><span class="line">* @param groupName groupName</span><br><span class="line">* @param asyn asyn</span><br><span class="line">* @return BroadcastResult</span><br><span class="line">*/</span><br><span class="line">BroadcastResult sendToGroup(BaseNulsData event, String groupName, boolean asyn);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 重置网络</span><br><span class="line">* reset network module</span><br><span class="line">*/</span><br><span class="line">void reset();</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* 获取网络配置信息</span><br><span class="line">* Get network configuration information</span><br><span class="line">*</span><br><span class="line">* @return NetworkParam</span><br><span class="line">*/</span><br><span class="line">NetworkParam getNetworkParam();</span><br></pre></td></tr></table></figure>
<h2 id="四-模块协议" class="article-heading"><a href="#四-模块协议" class="headerlink" title="四 模块协议"></a>四 模块协议<a class="article-anchor" href="#四-模块协议" aria-hidden="true"></a></h2><p>网络模块，协议模块ID = 4</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">short NETWORK_MODULE_ID = 4;</span><br></pre></td></tr></table></figure>
<ul>
<li>Node            p2p节点信息</li>
</ul>
<table>
<thead>
<tr>
<th>尺寸</th>
<th>字段</th>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>magicNumber</td>
<td>uint32</td>
<td>魔法参数</td>
</tr>
<tr>
<td>2</td>
<td>port</td>
<td>uint16</td>
<td>服务监听端口</td>
</tr>
<tr>
<td>??</td>
<td>IP</td>
<td>VarString</td>
<td>节点IP</td>
</tr>
</tbody>
</table>
<ul>
<li>HandshakeMessage                  节点握手信息</li>
</ul>
<table>
<thead>
<tr>
<th>尺寸</th>
<th>字段</th>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>handshakeType</td>
<td>uint16</td>
<td>1. 请求   2. 响应</td>
</tr>
<tr>
<td>2</td>
<td>ServerPort</td>
<td>uint16</td>
<td>服务监听端口</td>
</tr>
<tr>
<td>4</td>
<td>BestBlockHeight</td>
<td>uint32</td>
<td>最高高度</td>
</tr>
<tr>
<td>??</td>
<td>BestBlockHash</td>
<td>VarString</td>
<td>最高块Hash字符串</td>
</tr>
<tr>
<td>6</td>
<td>networkTime</td>
<td>uint48</td>
<td>网络时间</td>
</tr>
<tr>
<td>??</td>
<td>nodeIp</td>
<td>VarString</td>
<td>对方网络地址</td>
</tr>
<tr>
<td>??</td>
<td>Version</td>
<td>VarString</td>
<td>版本字符串</td>
</tr>
</tbody>
</table>
<ul>
<li>P2PNodeMessage                  新节点广播信息</li>
</ul>
<table>
<thead>
<tr>
<th>尺寸</th>
<th>字段</th>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>Port</td>
<td>uint16</td>
<td>服务监听端口</td>
</tr>
<tr>
<td>??</td>
<td>IP</td>
<td>VarString</td>
<td>节点IP</td>
</tr>
</tbody>
</table>
<ul>
<li>NodesMessage                      节点集合信息</li>
</ul>
<table>
<thead>
<tr>
<th>尺寸</th>
<th>字段</th>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>??</td>
<td>NodeCount</td>
<td>VarInt</td>
<td>节点数</td>
</tr>
<tr>
<td>??</td>
<td>Node[]</td>
<td>Node[NodeCount]</td>
<td>节点信息数组</td>
</tr>
</tbody>
</table>
<ul>
<li>GetVersionMessage             获取节点版本信息</li>
</ul>
<table>
<thead>
<tr>
<th>尺寸</th>
<th>字段</th>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>handshakeType</td>
<td>uint16</td>
<td>1. 请求   2. 响应</td>
</tr>
<tr>
<td>2</td>
<td>ServerPort</td>
<td>uint16</td>
<td>服务监听端口</td>
</tr>
<tr>
<td>4</td>
<td>BestBlockHeight</td>
<td>uint32</td>
<td>最高高度</td>
</tr>
<tr>
<td>??</td>
<td>BestBlockHash</td>
<td>VarString</td>
<td>最高块Hash字符串</td>
</tr>
<tr>
<td>6</td>
<td>networkTime</td>
<td>uint48</td>
<td>网络时间</td>
</tr>
<tr>
<td>??</td>
<td>nodeIp</td>
<td>VarString</td>
<td>对方网络地址</td>
</tr>
<tr>
<td>??</td>
<td>Version</td>
<td>VarString</td>
<td>版本字符串</td>
</tr>
</tbody>
</table>
<ul>
<li>NETWORK_VERSION</li>
</ul>
<table>
<thead>
<tr>
<th>尺寸</th>
<th>字段</th>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>handshakeType</td>
<td>uint16</td>
<td>1. 请求   2. 响应</td>
</tr>
<tr>
<td>2</td>
<td>ServerPort</td>
<td>uint16</td>
<td>服务监听端口</td>
</tr>
<tr>
<td>4</td>
<td>BestBlockHeight</td>
<td>uint32</td>
<td>最高高度</td>
</tr>
<tr>
<td>??</td>
<td>BestBlockHash</td>
<td>VarString</td>
<td>最高块Hash字符串</td>
</tr>
<tr>
<td>6</td>
<td>networkTime</td>
<td>uint48</td>
<td>网络时间</td>
</tr>
<tr>
<td>??</td>
<td>nodeIp</td>
<td>VarString</td>
<td>对方网络地址</td>
</tr>
<tr>
<td>??</td>
<td>Version</td>
<td>VarString</td>
<td>版本字符串</td>
</tr>
</tbody>
</table>
<h2 id="五-模块架构" class="article-heading"><a href="#五-模块架构" class="headerlink" title="五 模块架构"></a>五 模块架构<a class="article-anchor" href="#五-模块架构" aria-hidden="true"></a></h2><p><img src="network/network架构图.png" alt="网络模块架构图"></p>
<h2 id="六-核心流程" class="article-heading"><a href="#六-核心流程" class="headerlink" title="六 核心流程"></a>六 核心流程<a class="article-anchor" href="#六-核心流程" aria-hidden="true"></a></h2><h4 id="6-1发现节点、建立连接" class="article-heading"><a href="#6-1发现节点、建立连接" class="headerlink" title="6.1发现节点、建立连接"></a>6.1发现节点、建立连接<a class="article-anchor" href="#6-1发现节点、建立连接" aria-hidden="true"></a></h4><p>​    NULS的每个节点既是客户端又是服务器，因此发现节点、建立连接需要从主动发起连接访问其他节点的服务器，和被动等待其他人连接自己的服务器两个方面进行描述。</p>
<p><img src="network/node1.png" alt=""></p>
<p><img src="network/node2.png" alt=""></p>
<h4 id="7-2消息的接收与处理" class="article-heading"><a href="#7-2消息的接收与处理" class="headerlink" title="7.2消息的接收与处理"></a>7.2消息的接收与处理<a class="article-anchor" href="#7-2消息的接收与处理" aria-hidden="true"></a></h4><p>​    <img src="network/message.png" alt=""></p>
<h2 id="7-模块类图" class="article-heading"><a href="#7-模块类图" class="headerlink" title="7 模块类图"></a>7 模块类图<a class="article-anchor" href="#7-模块类图" aria-hidden="true"></a></h2><p><img src="network/network类图1.png" alt=""></p>
<p><img src="network/network类图2.png" alt=""></p>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-01-02T05:45:52.121Z" itemprop="dateModified">上次更新：2019-01-02</time>
                <a href="message_bus.html" class="article-footer-prev" title="消息总线"><i class="fa fa-chevron-left"></i><span>上一页</span></a><a href="storage.html" class="article-footer-next" title="存储模块"><span>下一页</span><i class="fa fa-chevron-right"></i></a>
              </footer>
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">目录</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#模块概述"><span class="toc-text">模块概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-模块功能"><span class="toc-text">二 模块功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-节点发现"><span class="toc-text">1.节点发现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-消息接收与处理"><span class="toc-text">2.消息接收与处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-消息广播"><span class="toc-text">3.消息广播</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-节点分组"><span class="toc-text">4.节点分组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-模块接口"><span class="toc-text">三 模块接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四-模块协议"><span class="toc-text">四 模块协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五-模块架构"><span class="toc-text">五 模块架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六-核心流程"><span class="toc-text">六 核心流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1发现节点、建立连接"><span class="toc-text">6.1发现节点、建立连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2消息的接收与处理"><span class="toc-text">7.2消息的接收与处理</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#7-模块类图"><span class="toc-text">7 模块类图</span></a></li>
              <a href="#" id="article-toc-top">回到顶部</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">基础</strong><a href="index.html" class="sidebar-link">总体架构</a><a href="modularity.html" class="sidebar-link">为什么模块化</a><a href="structure.html" class="sidebar-link">源码结构</a><a href="modular_overview.html" class="sidebar-link">模块说明</a><a href="micro_kernel.html" class="sidebar-link">微内核</a><a href="message_bus.html" class="sidebar-link">消息总线</a><strong class="sidebar-title">模块说明</strong><a href="network_overview.html" class="sidebar-link current">网络模块</a><a href="storage.html" class="sidebar-link">存储模块</a><a href="account.html" class="sidebar-link">账户模块</a><a href="ledger.html" class="sidebar-link">账本模块</a><a href="protocol.html" class="sidebar-link">通用协议</a><a href="consensus.html" class="sidebar-link">共识模块</a><a href="contract.html" class="sidebar-link">智能合约</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <div class="footer-index" id="footer">
   <div class="footer-index-inner">
      <div class="footer-left">
         <div>© 2018 <a href="https://nuls.io" target="_blank">Nuls</a></div>
         <div>Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a></div>
         <div>Power by <a href="https://hexo.io" target="_blank">HEXO</a></div>
      </div>
      <div class="footer-middle">
        <div>
          <a href="https://twitter.com/nulsservice" target="_blank"><i class="footer-icon1"></i></a>
        </div>
        <div>
         <a href="https://www.reddit.com/r/nulsservice/" target="_blank"><i class="footer-icon2"></i></a>
        </div>
        <div>
          <a href="https://t.me/Nulsio" target="_blank"><i class="footer-icon3"></i></a>
        </div>
        <div>
           <a href="https://steemit.com/@nuls" target="_blank"><i class="footer-icon4"></i></a>
        </div>
        <div>
          <a href="https://github.com/nuls-io/nuls" target="_blank"><i class="footer-icon5"></i></a>
        </div>
        <div>
          <a href="https://www.facebook.com/nulscommunity/" target="_blank"><i class="footer-icon6"></i></a>
        </div>
        <div>
          <a href="https://join.slack.com/t/nuls/shared_invite/enQtMjQ4MTM4ODAyNTI4LWJjNGMwYTE0YjRlYmFlZGUwM2JhOGE4MDIwZmE4MzA2MDg1YzUyMmVkN2RhZjkyNWMzZjY5ZDU5ZmViMjZjNGQ" target="_blank"><i class="footer-icon7"></i></a>
        </div>
        <div>
          <a href="https://gitter.im/nuls_io" target="_blank"><i class="footer-icon8"></i></a>
        </div>
      </div>
   </div>
</div>
  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/zh-cn/docs/" class="mobile-nav-link">文档</a><a href="/zh-cn/protocol/" class="mobile-nav-link">协议</a><a href="/zh-cn/contract/" class="mobile-nav-link">智能合约</a><a href="/zh-cn/chain/" class="mobile-nav-link">跨链</a><a href="/zh-cn/manual/" class="mobile-nav-link">参考手册</a><a href="/news/" class="mobile-nav-link">新闻</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/nuls-io/nuls" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">基础</strong><a href="index.html" class="mobile-nav-link">总体架构</a><a href="modularity.html" class="mobile-nav-link">为什么模块化</a><a href="structure.html" class="mobile-nav-link">源码结构</a><a href="modular_overview.html" class="mobile-nav-link">模块说明</a><a href="micro_kernel.html" class="mobile-nav-link">微内核</a><a href="message_bus.html" class="mobile-nav-link">消息总线</a><strong class="mobile-nav-title">模块说明</strong><a href="network_overview.html" class="mobile-nav-link current">网络模块</a><a href="storage.html" class="mobile-nav-link">存储模块</a><a href="account.html" class="mobile-nav-link">账户模块</a><a href="ledger.html" class="mobile-nav-link">账本模块</a><a href="protocol.html" class="mobile-nav-link">通用协议</a><a href="consensus.html" class="mobile-nav-link">共识模块</a><a href="contract.html" class="mobile-nav-link">智能合约</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></span>
    <select id="mobile-lang-select" data-canonical="manual/network_overview.html">
      
        <option value="en">English</option>
      
        <option value="zh-cn" selected>简体中文</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<script src="/js/common.js"></script>
<!-- endbuild -->

</body>
</html>