<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>NULS</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://nuls-io.github.io/zh-cn/contract/index.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://nuls-io.github.io/contract/index.html">
    
      <link rel="alternative" hreflang="zh-cn" href="https://nuls-io.github.io/zh-cn/contract/index.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="generator" content="Hexo 3.8.0">
  <!-- CSS -->
  <!-- build:css build/css/nuls.css -->
  <link rel="stylesheet" href="/css/nuls.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="NULS">
</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/zh-cn/" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="/zh-cn/docs/" class="main-nav-link">文档</a><a href="/zh-cn/protocol/" class="main-nav-link">协议</a><a href="/zh-cn/contract/" class="main-nav-link">智能合约</a><a href="/zh-cn/chain/" class="main-nav-link">跨链</a><a href="/zh-cn/manual/" class="main-nav-link">参考手册</a><a href="/news/" class="main-nav-link">新闻</a>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></label>
      <select id="lang-select" data-canonical="contract/index.html">
        
          <option value="en">English</option>
        
          <option value="zh-cn" selected>简体中文</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope="" itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name"></h1>
                <a href="https://github.com/nuls-io/devsite/edit/master/source/zh-cn/contract/index.md" class="article-edit-link" title="改进本文"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h1 id="NULS智能合约开发手册" class="article-heading"><a href="#NULS智能合约开发手册" class="headerlink" title="NULS智能合约开发手册"></a>NULS智能合约开发手册<a class="article-anchor" href="#NULS智能合约开发手册" aria-hidden="true"></a></h1><h2 id="1-简介" class="article-heading"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介<a class="article-anchor" href="#1-简介" aria-hidden="true"></a></h2><p>NULS智能合约使用Java进行开发，合约运行在NULS虚拟机中。合约开发不能使用所有的Java特性，在第3节列出具体限制。</p>
<h2 id="2-开发环境" class="article-heading"><a href="#2-开发环境" class="headerlink" title="2. 开发环境"></a>2. 开发环境<a class="article-anchor" href="#2-开发环境" aria-hidden="true"></a></h2><h3 id="2-1-安装NULS钱包" class="article-heading"><a href="#2-1-安装NULS钱包" class="headerlink" title="2.1 安装NULS钱包"></a>2.1 安装NULS钱包<a class="article-anchor" href="#2-1-安装NULS钱包" aria-hidden="true"></a></h3><h3 id="2-2-安装JDK-8" class="article-heading"><a href="#2-2-安装JDK-8" class="headerlink" title="2.2 安装JDK 8"></a>2.2 安装JDK 8<a class="article-anchor" href="#2-2-安装JDK-8" aria-hidden="true"></a></h3><h3 id="2-3-安装IntelliJ-IDEA" class="article-heading"><a href="#2-3-安装IntelliJ-IDEA" class="headerlink" title="2.3 安装IntelliJ IDEA"></a>2.3 安装IntelliJ IDEA<a class="article-anchor" href="#2-3-安装IntelliJ-IDEA" aria-hidden="true"></a></h3><p>Nuls智能合约使用的开发工具为IntelliJ IDEA。</p>
<h3 id="2-4-安装NULS智能合约插件" class="article-heading"><a href="#2-4-安装NULS智能合约插件" class="headerlink" title="2.4 安装NULS智能合约插件"></a>2.4 安装NULS智能合约插件<a class="article-anchor" href="#2-4-安装NULS智能合约插件" aria-hidden="true"></a></h3><p><a href="https://nuls-usa-west.oss-us-west-1.aliyuncs.com/plugins/Docs%26plugin.zip" target="_blank" rel="noopener">点击下载插件</a></p>
<p>NULS智能合约插件提供的主要功能：</p>
<ul>
<li>新建NULS合约工程</li>
<li>提示不支持的Java特性、Java类、Java方法</li>
<li>编译、打包、部署合约</li>
<li>展示、调用合约方法。</li>
</ul>
<h2 id="3-NULS智能合约规范与语法" class="article-heading"><a href="#3-NULS智能合约规范与语法" class="headerlink" title="3. NULS智能合约规范与语法"></a>3. NULS智能合约规范与语法<a class="article-anchor" href="#3-NULS智能合约规范与语法" aria-hidden="true"></a></h2><p>Nuls智能合约语法是Java语法的一个子集，在Java语法上做了一些限制。</p>
<h3 id="3-1-NULS智能合约规范" class="article-heading"><a href="#3-1-NULS智能合约规范" class="headerlink" title="3.1 NULS智能合约规范"></a>3.1 NULS智能合约规范<a class="article-anchor" href="#3-1-NULS智能合约规范" aria-hidden="true"></a></h3><blockquote>
<p><strong><em>合约主类必须实现Contract接口，一个智能合约只能有一个类实现Contract接口，其他类和接口都是为这个合约提供功能的。</em></strong></p>
</blockquote>
<h3 id="3-2-关键字" class="article-heading"><a href="#3-2-关键字" class="headerlink" title="3.2 关键字"></a>3.2 关键字<a class="article-anchor" href="#3-2-关键字" aria-hidden="true"></a></h3><p>下面列出Java关键字，其中将标注NULS智能合约不支持的关键字</p>
<p>访问控制</p>
<ul>
<li>public</li>
<li>protected</li>
<li>private</li>
</ul>
<p>定义类、接口、抽象类和实现接口、继承类的关键字、实例化对象</p>
<ul>
<li>class</li>
<li>interface</li>
<li>abstract</li>
<li>implements</li>
<li>extends</li>
<li>new</li>
</ul>
<p>包的关键字</p>
<ul>
<li>import</li>
<li>package</li>
</ul>
<p>数据类型的关键字</p>
<ul>
<li>byte</li>
<li>char</li>
<li>boolean</li>
<li>short</li>
<li>int</li>
<li>float</li>
<li>long</li>
<li>double</li>
<li>void</li>
<li>null</li>
<li>true</li>
<li>false</li>
</ul>
<p>条件循环（流程控制）</p>
<ul>
<li>if</li>
<li>else</li>
<li>while</li>
<li>for</li>
<li>switch</li>
<li>case</li>
<li>default</li>
<li>do</li>
<li>break</li>
<li>continue</li>
<li>return</li>
<li>instanceof</li>
</ul>
<p>错误处理</p>
<ul>
<li>catch</li>
<li>try</li>
<li>finally</li>
<li>throw</li>
<li>throws</li>
</ul>
<p>修饰方法、类、属性和变量</p>
<ul>
<li>static</li>
<li>final</li>
<li>super</li>
<li>this</li>
<li>native（不支持）</li>
<li>strictfp（不支持）</li>
<li>synchronized（不支持）</li>
<li>transient（不支持）</li>
<li>volatile（不支持）</li>
</ul>
<p>其他</p>
<ul>
<li>enum（不支持）</li>
<li>assert（不支持）</li>
</ul>
<h3 id="3-3-基本语法" class="article-heading"><a href="#3-3-基本语法" class="headerlink" title="3.3 基本语法"></a>3.3 基本语法<a class="article-anchor" href="#3-3-基本语法" aria-hidden="true"></a></h3><p>下面的语法与Java相同，只是简单列出，具体可参考Java相关文档</p>
<ul>
<li>标识符：由字符、下划线、美元符或数字组成，以字符、下划线、美元符开头</li>
<li>基本数据类型：byte short int long float double char boolean</li>
<li>引用数据类型：类、接口、数组</li>
<li>算术运算符：+        -        *        /        %        ++        –</li>
<li>关系运算符：&gt;        &lt;        &gt;=        &lt;=        ==        !=  </li>
<li>逻辑运算符：!        &amp;        |        ^        &amp;&amp;        ||</li>
<li>位运算符：&amp;        |        ^        ~        &gt;&gt;        &lt;&lt;        &gt;&gt;&gt;</li>
<li>赋值运算符：=</li>
<li>拓展赋值运算符：+        =        -=        *=        /=</li>
<li>字符串链接运算符：+</li>
<li>三目条件运算符          ?        :</li>
<li>流程控制语句（if,switch,for,while,do…while）</li>
</ul>
<h3 id="3-4-支持的类" class="article-heading"><a href="#3-4-支持的类" class="headerlink" title="3.4 支持的类"></a>3.4 支持的类<a class="article-anchor" href="#3-4-支持的类" aria-hidden="true"></a></h3><p>Nuls智能合约只能使用下面的类进行开发</p>
<ul>
<li>io.nuls.contract.sdk.Address</li>
<li>io.nuls.contract.sdk.Block</li>
<li>io.nuls.contract.sdk.BlockHeader</li>
<li>io.nuls.contract.sdk.Contract</li>
<li>io.nuls.contract.sdk.Event</li>
<li>io.nuls.contract.sdk.Msg</li>
<li>io.nuls.contract.sdk.Utils</li>
<li>io.nuls.contract.sdk.annotation.View</li>
<li>io.nuls.contract.sdk.annotation.Required</li>
<li>io.nuls.contract.sdk.annotation.Payable</li>
<li>java.lang.Boolean</li>
<li>java.lang.Byte</li>
<li>java.lang.Short</li>
<li>java.lang.Character</li>
<li>java.lang.Integer</li>
<li>java.lang.Long</li>
<li>java.lang.Float</li>
<li>java.lang.Double</li>
<li>java.lang.String</li>
<li>java.lang.StringBuilder</li>
<li>java.math.BigInteger</li>
<li>java.math.BigDecimal</li>
<li>java.util.Collection</li>
<li>java.util.List</li>
<li>java.util.ArrayList</li>
<li>java.util.LinkedList</li>
<li>java.util.Map</li>
<li>java.util.HashMap</li>
<li>java.util.LinkedHashMap</li>
<li>java.util.Set</li>
<li>java.util.HashSet</li>
</ul>
<h3 id="3-5-其他限制" class="article-heading"><a href="#3-5-其他限制" class="headerlink" title="3.5 其他限制"></a>3.5 其他限制<a class="article-anchor" href="#3-5-其他限制" aria-hidden="true"></a></h3><ul>
<li>合约类只能有一个构造方法，其他类不限制</li>
<li>执行一次合约方法最大的Gas消耗是1000万，包括<code>@View</code>类型的方法调用，请保证尽可能的优化合约代码</li>
</ul>
<h2 id="4-NULS智能合约简单示例" class="article-heading"><a href="#4-NULS智能合约简单示例" class="headerlink" title="4. NULS智能合约简单示例"></a>4. NULS智能合约简单示例<a class="article-anchor" href="#4-NULS智能合约简单示例" aria-hidden="true"></a></h2><p>一个简单的合约</p>
<blockquote>
<p><strong><em>合约主类必须实现Contract接口，其他类和接口都是为这个合约提供功能的。</em></strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> contracts.examples;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Contract;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.Payable;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.Required;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleStorage</span> <span class="keyword">implements</span> <span class="title">Contract</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String storedData;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStoredData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> storedData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Payable</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStoredData</span><span class="params">(@Required String storedData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.storedData = storedData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在一个合约项目中，只需要引入jar包：contract-sdk.jar，这个包提供了获取区块信息和交易信息的类。<br>项目中可以有多个类和接口。</p>
<p>合约写好后，编译打包，部署到NULS链上时候，虚拟机会执行合约的构造方法初始化这个合约，并把这个合约状态保存在链上，合约状态是合约类的所有成员变量。<br>合约部署好以后，合约类的所有public方法都是能调用的，通过调用这些方法读取或修改合约状态。</p>
<p>注解说明</p>
<p>@View 标记@View的方法，调用后合约状态不会改变，可以通过这种方法查询合约状态。</p>
<p>@Payable 标记@Payable的方法，才能在调用时候传入金额</p>
<p>@Required 标记@Required的参数，调用时候必须传入值</p>
<p>去github下载NULS源码，里面有一些合约示例。</p>
<h2 id="5-NULS-Contract-SDK" class="article-heading"><a href="#5-NULS-Contract-SDK" class="headerlink" title="5. NULS Contract SDK"></a>5. NULS Contract SDK<a class="article-anchor" href="#5-NULS-Contract-SDK" aria-hidden="true"></a></h2><p>合约SDK提供了几个类，方便合约开发：</p>
<h3 id="io-nuls-contract-sdk-Address" class="article-heading"><a href="#io-nuls-contract-sdk-Address" class="headerlink" title="io.nuls.contract.sdk.Address"></a>io.nuls.contract.sdk.Address<a class="article-anchor" href="#io-nuls-contract-sdk-Address" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Address</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        valid(address);</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取该地址的余额（只能获取合约地址余额）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> BigInteger <span class="title">balance</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 合约向该地址转账</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value 转账金额（多少Na）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(BigInteger value)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 调用该地址的合约方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodName 方法名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodDesc 方法签名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args       参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value      附带的货币量（多少Na）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String methodName, String methodDesc, String[][] args, BigInteger value)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 调用该地址的合约方法并带有返回值(String)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodName 方法名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodDesc 方法签名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args       参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value      附带的货币量（多少Na）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 调用合约后的返回值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">callWithReturnValue</span><span class="params">(String methodName, String methodDesc, String[][] args, BigInteger value)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证地址</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> io.nuls.kernel.utils.AddressTool#validAddress(String)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">valid</span><span class="params">(String address)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == o) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Address address1 = (Address) o;</span><br><span class="line">        <span class="keyword">return</span> address != <span class="keyword">null</span> ? address.equals(address1.address) : address1.address == <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address != <span class="keyword">null</span> ? address.hashCode() : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-Block" class="article-heading"><a href="#io-nuls-contract-sdk-Block" class="headerlink" title="io.nuls.contract.sdk.Block"></a>io.nuls.contract.sdk.Block<a class="article-anchor" href="#io-nuls-contract-sdk-Block" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Block</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 给定块的区块头</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> blockNumber</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> BlockHeader <span class="title">getBlockHeader</span><span class="params">(<span class="keyword">long</span> blockNumber)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前块的区块头</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> BlockHeader <span class="title">currentBlockHeader</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 最新块的区块头</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 最新块的区块头</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> BlockHeader <span class="title">newestBlockHeader</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 给定块的哈希值</span></span><br><span class="line"><span class="comment">     * hash of the given block</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> blockNumber</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">blockhash</span><span class="params">(<span class="keyword">long</span> blockNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getBlockHeader(blockNumber).getHash();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前块矿工地址</span></span><br><span class="line"><span class="comment">     * current block miner’s address</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Address <span class="title">coinbase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentBlockHeader().getPackingAddress();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前块编号</span></span><br><span class="line"><span class="comment">     * current block number</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">number</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentBlockHeader().getHeight();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前块时间戳</span></span><br><span class="line"><span class="comment">     * current block timestamp</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">timestamp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentBlockHeader().getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-BlockHeader" class="article-heading"><a href="#io-nuls-contract-sdk-BlockHeader" class="headerlink" title="io.nuls.contract.sdk.BlockHeader"></a>io.nuls.contract.sdk.BlockHeader<a class="article-anchor" href="#io-nuls-contract-sdk-BlockHeader" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BlockHeader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String hash;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> time;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> height;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> txCount;</span><br><span class="line">    <span class="keyword">private</span> Address packingAddress;</span><br><span class="line">    <span class="keyword">private</span> String stateRoot;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getHash</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hash;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getTxCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> txCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Address <span class="title">getPackingAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> packingAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStateRoot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stateRoot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        BlockHeader that = (BlockHeader) o;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (time != that.time) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (height != that.height) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (txCount != that.txCount) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (hash != <span class="keyword">null</span> ? !hash.equals(that.hash) : that.hash != <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (packingAddress != <span class="keyword">null</span> ? !packingAddress.equals(that.packingAddress) : that.packingAddress != <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> stateRoot != <span class="keyword">null</span> ? stateRoot.equals(that.stateRoot) : that.stateRoot == <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = hash != <span class="keyword">null</span> ? hash.hashCode() : <span class="number">0</span>;</span><br><span class="line">        result = <span class="number">31</span> * result + (<span class="keyword">int</span>) (time ^ (time &gt;&gt;&gt; <span class="number">32</span>));</span><br><span class="line">        result = <span class="number">31</span> * result + (<span class="keyword">int</span>) (height ^ (height &gt;&gt;&gt; <span class="number">32</span>));</span><br><span class="line">        result = <span class="number">31</span> * result + (<span class="keyword">int</span>) (txCount ^ (txCount &gt;&gt;&gt; <span class="number">32</span>));</span><br><span class="line">        result = <span class="number">31</span> * result + (packingAddress != <span class="keyword">null</span> ? packingAddress.hashCode() : <span class="number">0</span>);</span><br><span class="line">        result = <span class="number">31</span> * result + (stateRoot != <span class="keyword">null</span> ? stateRoot.hashCode() : <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"BlockHeader&#123;"</span> +</span><br><span class="line">                <span class="string">"hash='"</span> + hash + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", time="</span> + time +</span><br><span class="line">                <span class="string">", height="</span> + height +</span><br><span class="line">                <span class="string">", txCount="</span> + txCount +</span><br><span class="line">                <span class="string">", packingAddress="</span> + packingAddress +</span><br><span class="line">                <span class="string">", stateRoot='"</span> + stateRoot + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-Contract" class="article-heading"><a href="#io-nuls-contract-sdk-Contract" class="headerlink" title="io.nuls.contract.sdk.Contract"></a>io.nuls.contract.sdk.Contract<a class="article-anchor" href="#io-nuls-contract-sdk-Contract" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 合约接口，合约类实现这个接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Contract</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 直接向合约转账，会调用这个方法，默认不做任何操作，如果合约地址要接受直接转账，可以重载这个方法，并且标记`<span class="doctag">@Payable</span>`注解。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">_payable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-Event" class="article-heading"><a href="#io-nuls-contract-sdk-Event" class="headerlink" title="io.nuls.contract.sdk.Event"></a>io.nuls.contract.sdk.Event<a class="article-anchor" href="#io-nuls-contract-sdk-Event" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 事件接口，事件类实现这个接口</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Event</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-Msg" class="article-heading"><a href="#io-nuls-contract-sdk-Msg" class="headerlink" title="io.nuls.contract.sdk.Msg"></a>io.nuls.contract.sdk.Msg<a class="article-anchor" href="#io-nuls-contract-sdk-Msg" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Msg</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 剩余Gas</span></span><br><span class="line"><span class="comment">     * remaining gas</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">long</span> <span class="title">gasleft</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 合约发送者地址</span></span><br><span class="line"><span class="comment">     * sender of the contract</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> Address <span class="title">sender</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 合约发送者转入合约地址的Nuls数量，单位是Na，1Nuls=1亿Na</span></span><br><span class="line"><span class="comment">     * The number of Nuls transferred by the contract sender to the contract address, the unit is Na, 1Nuls = 1 billion Na</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> BigInteger <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gas价格</span></span><br><span class="line"><span class="comment">     * gas price</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">long</span> <span class="title">gasprice</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 合约地址</span></span><br><span class="line"><span class="comment">     * contract address</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> Address <span class="title">address</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-Utils" class="article-heading"><a href="#io-nuls-contract-sdk-Utils" class="headerlink" title="io.nuls.contract.sdk.Utils"></a>io.nuls.contract.sdk.Utils<a class="article-anchor" href="#io-nuls-contract-sdk-Utils" aria-hidden="true"></a></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Utils</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查条件，如果条件不满足则回滚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expression</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">require</span><span class="params">(<span class="keyword">boolean</span> expression)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!expression) &#123;</span><br><span class="line">            revert();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查条件，如果条件不满足则回滚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expression</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> errorMessage</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">require</span><span class="params">(<span class="keyword">boolean</span> expression, String errorMessage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!expression) &#123;</span><br><span class="line">            revert(errorMessage);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 终止执行并还原改变的状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">revert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        revert(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 终止执行并还原改变的状态</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> errorMessage</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">revert</span><span class="params">(String errorMessage)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送事件</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> event</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">emit</span><span class="params">(Event event)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> seed a private seed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> pseudo random number (0 ~ 1)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> <span class="title">pseudoRandom</span><span class="params">(<span class="keyword">long</span> seed)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> hash1 = Block.currentBlockHeader().getPackingAddress().toString().substring(<span class="number">2</span>).hashCode();</span><br><span class="line">        <span class="keyword">int</span> hash2 = Msg.address().toString().substring(<span class="number">2</span>).hashCode();</span><br><span class="line">        <span class="keyword">int</span> hash3 = Msg.sender() != <span class="keyword">null</span> ? Msg.sender().toString().substring(<span class="number">2</span>).hashCode() : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> hash4 = Long.valueOf(Block.timestamp()).toString().hashCode();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> hash = seed ^ hash1 ^ hash2 ^ hash3 ^ hash4;</span><br><span class="line"></span><br><span class="line">        seed = (hash * <span class="number">0x5DEECE66DL</span> + <span class="number">0xBL</span>) &amp; ((<span class="number">1L</span> &lt;&lt; <span class="number">48</span>) - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ((<span class="keyword">int</span>) (seed &gt;&gt;&gt; <span class="number">24</span>) / (<span class="keyword">float</span>) (<span class="number">1</span> &lt;&lt; <span class="number">24</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> pseudo random number (0 ~ 1)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> <span class="title">pseudoRandom</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pseudoRandom(<span class="number">0x5DEECE66DL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src source string</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> sha3-256 hash (utf-8 encode)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">sha3</span><span class="params">(String src)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes source byte array</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> sha3-256 hash</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title">sha3</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span></span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-annotation-Payable" class="article-heading"><a href="#io-nuls-contract-sdk-annotation-Payable" class="headerlink" title="io.nuls.contract.sdk.annotation.Payable"></a>io.nuls.contract.sdk.annotation.Payable<a class="article-anchor" href="#io-nuls-contract-sdk-annotation-Payable" aria-hidden="true"></a></h3><p><code>@Payable 标记@Payable的方法，才能在调用时候转入金额</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Payable &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-annotation-Required" class="article-heading"><a href="#io-nuls-contract-sdk-annotation-Required" class="headerlink" title="io.nuls.contract.sdk.annotation.Required"></a>io.nuls.contract.sdk.annotation.Required<a class="article-anchor" href="#io-nuls-contract-sdk-annotation-Required" aria-hidden="true"></a></h3><p><code>@Required 标记@Required的参数，调用时候必须传入值</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.PARAMETER&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Required &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="io-nuls-contract-sdk-annotation-View" class="article-heading"><a href="#io-nuls-contract-sdk-annotation-View" class="headerlink" title="io.nuls.contract.sdk.annotation.View"></a>io.nuls.contract.sdk.annotation.View<a class="article-anchor" href="#io-nuls-contract-sdk-annotation-View" aria-hidden="true"></a></h3><p><code>@View 标记@View的方法，调用后合约状态不会改变，可以通过这种方法查询合约状态。</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> View &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-智能合约主要的RPC接口" class="article-heading"><a href="#6-智能合约主要的RPC接口" class="headerlink" title="6. 智能合约主要的RPC接口"></a>6. 智能合约主要的RPC接口<a class="article-anchor" href="#6-智能合约主要的RPC接口" aria-hidden="true"></a></h2><p>这里列举几个接口的参数结构及简单实例，其他接口请参见<a href="http://127.0.0.1:8001/docs#/" target="_blank" rel="noopener">Swagger UI</a></p>
<blockquote>
<p>测试网的<code>Swagger UI</code>的端口默认是8001，正式网的端口默认是6001</p>
</blockquote>
<h3 id="6-1-创建智能合约" class="article-heading"><a href="#6-1-创建智能合约" class="headerlink" title="6.1 创建智能合约"></a>6.1 创建智能合约<a class="article-anchor" href="#6-1-创建智能合约" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/create</code> </li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">sender*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">交易创建者</td>
</tr>
<tr>
<td style="text-align:center">password*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">交易创建者账户密码</td>
</tr>
<tr>
<td style="text-align:center">gasLimit*</td>
<td style="text-align:center">long</td>
<td style="text-align:center">最大gas消耗</td>
</tr>
<tr>
<td style="text-align:center">price*</td>
<td style="text-align:center">long</td>
<td style="text-align:center">执行合约单价</td>
</tr>
<tr>
<td style="text-align:center">contractCode*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">智能合约代码(字节码的Hex编码字符串)</td>
</tr>
<tr>
<td style="text-align:center">remark</td>
<td style="text-align:center">string</td>
<td style="text-align:center">备注</td>
</tr>
<tr>
<td style="text-align:center">args</td>
<td style="text-align:center">string[][]</td>
<td style="text-align:center">参数列表</td>
</tr>
</tbody>
</table>
<ul>
<li>Example Value</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"sender"</span>: <span class="string">"Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M"</span>,</span><br><span class="line">  <span class="attr">"gasLimit"</span>: <span class="number">4687</span>,</span><br><span class="line">  <span class="attr">"price"</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">"password"</span>: <span class="string">"xxx"</span>,</span><br><span class="line">  <span class="attr">"contractCode"</span>: <span class="string">"504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000"</span>,</span><br><span class="line">  <span class="attr">"remark"</span>: <span class="string">"asd"</span>,</span><br><span class="line">  <span class="attr">"args"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-2-估算创建智能合约的Gas消耗" class="article-heading"><a href="#6-2-估算创建智能合约的Gas消耗" class="headerlink" title="6.2 估算创建智能合约的Gas消耗"></a>6.2 估算创建智能合约的Gas消耗<a class="article-anchor" href="#6-2-估算创建智能合约的Gas消耗" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/imputedgas/create</code> </li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">sender*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">交易创建者</td>
</tr>
<tr>
<td style="text-align:center">password*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">交易创建者账户密码</td>
</tr>
<tr>
<td style="text-align:center">price*</td>
<td style="text-align:center">long</td>
<td style="text-align:center">执行合约单价</td>
</tr>
<tr>
<td style="text-align:center">contractCode*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">智能合约代码(字节码的Hex编码字符串)</td>
</tr>
<tr>
<td style="text-align:center">args</td>
<td style="text-align:center">string[][]</td>
<td style="text-align:center">参数列表</td>
</tr>
</tbody>
</table>
<ul>
<li>Example Value</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"sender"</span>: <span class="string">"Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M"</span>,</span><br><span class="line">  <span class="attr">"price"</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">"password"</span>: <span class="string">"xxx"</span>,</span><br><span class="line">  <span class="attr">"contractCode"</span>: <span class="string">"504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000"</span>,</span><br><span class="line">  <span class="attr">"args"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-3-调用智能合约" class="article-heading"><a href="#6-3-调用智能合约" class="headerlink" title="6.3 调用智能合约"></a>6.3 调用智能合约<a class="article-anchor" href="#6-3-调用智能合约" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/call</code> </li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">参数</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">sender*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">交易创建者</td>
</tr>
<tr>
<td style="text-align:center">password*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">交易创建者账户密码</td>
</tr>
<tr>
<td style="text-align:center">contractAddress*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">智能合约地址</td>
</tr>
<tr>
<td style="text-align:center">gasLimit*</td>
<td style="text-align:center">long</td>
<td style="text-align:center">最大Gas消耗</td>
</tr>
<tr>
<td style="text-align:center">price*</td>
<td style="text-align:center">long</td>
<td style="text-align:center">执行合约单价</td>
</tr>
<tr>
<td style="text-align:center">value</td>
<td style="text-align:center">long</td>
<td style="text-align:center">交易创建者向合约地址转账的金额(Na - 100000000Na=1NULS)</td>
</tr>
<tr>
<td style="text-align:center">methodName*</td>
<td style="text-align:center">string</td>
<td style="text-align:center">方法名</td>
</tr>
<tr>
<td style="text-align:center">methodDesc</td>
<td style="text-align:center">string</td>
<td style="text-align:center">方法签名，如果方法名不重复，可以不传</td>
</tr>
<tr>
<td style="text-align:center">remark</td>
<td style="text-align:center">string</td>
<td style="text-align:center">备注</td>
</tr>
<tr>
<td style="text-align:center">args</td>
<td style="text-align:center">string[][]</td>
<td style="text-align:center">参数列表</td>
</tr>
</tbody>
</table>
<ul>
<li>Example Value</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"sender"</span>: <span class="string">"Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M"</span>,</span><br><span class="line">  <span class="attr">"password"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"contractAddress"</span>: <span class="string">"NseBvPEzerLi3p5Me8Rbm7SeHThVGv1U"</span>,</span><br><span class="line">  <span class="attr">"gasLimit"</span>: <span class="number">8000</span>,</span><br><span class="line">  <span class="attr">"price"</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">"value"</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"methodName"</span>: <span class="string">"balance"</span>,</span><br><span class="line">  <span class="attr">"methodDesc"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"remark"</span>: <span class="string">"qwe"</span></span><br><span class="line">  <span class="string">"args"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-4-估算调用智能合约的Gas消耗-参见Swagger-UI" class="article-heading"><a href="#6-4-估算调用智能合约的Gas消耗-参见Swagger-UI" class="headerlink" title="6.4 估算调用智能合约的Gas消耗(参见Swagger UI)"></a>6.4 估算调用智能合约的Gas消耗(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-4-估算调用智能合约的Gas消耗-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/imputedgas/call</code> </li>
</ul>
<h3 id="6-5-估算智能合约的price-参见Swagger-UI" class="article-heading"><a href="#6-5-估算智能合约的price-参见Swagger-UI" class="headerlink" title="6.5 估算智能合约的price(参见Swagger UI)"></a>6.5 估算智能合约的price(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-5-估算智能合约的price-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/imputedprice</code></li>
</ul>
<h3 id="6-6-终止智能合约-参见Swagger-UI" class="article-heading"><a href="#6-6-终止智能合约-参见Swagger-UI" class="headerlink" title="6.6 终止智能合约(参见Swagger UI)"></a>6.6 终止智能合约(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-6-终止智能合约-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/delete</code> </li>
</ul>
<h3 id="6-7-调用不上链的智能合约函数-参见Swagger-UI" class="article-heading"><a href="#6-7-调用不上链的智能合约函数-参见Swagger-UI" class="headerlink" title="6.7 调用不上链的智能合约函数(参见Swagger UI)"></a>6.7 调用不上链的智能合约函数(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-7-调用不上链的智能合约函数-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/view</code> </li>
</ul>
<h3 id="6-8-获取智能合约执行结果-参见Swagger-UI" class="article-heading"><a href="#6-8-获取智能合约执行结果-参见Swagger-UI" class="headerlink" title="6.8 获取智能合约执行结果(参见Swagger UI)"></a>6.8 获取智能合约执行结果(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-8-获取智能合约执行结果-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/result/{hash}</code> </li>
</ul>
<h3 id="6-9-获取智能合约基本信息-参见Swagger-UI" class="article-heading"><a href="#6-9-获取智能合约基本信息-参见Swagger-UI" class="headerlink" title="6.9 获取智能合约基本信息(参见Swagger UI)"></a>6.9 获取智能合约基本信息(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-9-获取智能合约基本信息-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/info/{address}</code> </li>
</ul>
<h3 id="6-10-验证是否为合约地址-参见Swagger-UI" class="article-heading"><a href="#6-10-验证是否为合约地址-参见Swagger-UI" class="headerlink" title="6.10 验证是否为合约地址(参见Swagger UI)"></a>6.10 验证是否为合约地址(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-10-验证是否为合约地址-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/{address}</code> </li>
</ul>
<h3 id="6-11-获取智能合约地址的NULS余额-参见Swagger-UI" class="article-heading"><a href="#6-11-获取智能合约地址的NULS余额-参见Swagger-UI" class="headerlink" title="6.11 获取智能合约地址的NULS余额(参见Swagger UI)"></a>6.11 获取智能合约地址的NULS余额(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-11-获取智能合约地址的NULS余额-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/balance/{address}</code> </li>
</ul>
<h3 id="6-12-获取智能合约交易详情-参见Swagger-UI" class="article-heading"><a href="#6-12-获取智能合约交易详情-参见Swagger-UI" class="headerlink" title="6.12 获取智能合约交易详情(参见Swagger UI)"></a>6.12 获取智能合约交易详情(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-12-获取智能合约交易详情-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/tx/{hash}</code> </li>
</ul>
<h3 id="6-13-获取智能合约的交易列表-参见Swagger-UI" class="article-heading"><a href="#6-13-获取智能合约的交易列表-参见Swagger-UI" class="headerlink" title="6.13 获取智能合约的交易列表(参见Swagger UI)"></a>6.13 获取智能合约的交易列表(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-13-获取智能合约的交易列表-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/tx/list/{address}</code> </li>
</ul>
<h3 id="6-14-根据address和limit查询合约UTXO-参见Swagger-UI" class="article-heading"><a href="#6-14-根据address和limit查询合约UTXO-参见Swagger-UI" class="headerlink" title="6.14 根据address和limit查询合约UTXO(参见Swagger UI)"></a>6.14 根据address和limit查询合约UTXO(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-14-根据address和limit查询合约UTXO-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/limit/{address}/{limit}</code> </li>
</ul>
<h3 id="6-15-根据address和amount查询合约UTXO-参见Swagger-UI" class="article-heading"><a href="#6-15-根据address和amount查询合约UTXO-参见Swagger-UI" class="headerlink" title="6.15 根据address和amount查询合约UTXO(参见Swagger UI)"></a>6.15 根据address和amount查询合约UTXO(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-15-根据address和amount查询合约UTXO-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>GET <code>/api/contract/amount/{address}/{amount}</code> </li>
</ul>
<h3 id="6-16-向智能合约转账-参见Swagger-UI" class="article-heading"><a href="#6-16-向智能合约转账-参见Swagger-UI" class="headerlink" title="6.16 向智能合约转账(参见Swagger UI)"></a>6.16 向智能合约转账(参见<code>Swagger UI</code>)<a class="article-anchor" href="#6-16-向智能合约转账-参见Swagger-UI" aria-hidden="true"></a></h3><ul>
<li>POST <code>/api/contract/transfer</code> </li>
</ul>
<h2 id="7-示例" class="article-heading"><a href="#7-示例" class="headerlink" title="7. 示例"></a>7. 示例<a class="article-anchor" href="#7-示例" aria-hidden="true"></a></h2><h3 id="7-1-投票智能合约代码片段-如下" class="article-heading"><a href="#7-1-投票智能合约代码片段-如下" class="headerlink" title="7.1 投票智能合约代码片段, 如下"></a>7.1 投票智能合约代码<code>片段</code>, 如下<a class="article-anchor" href="#7-1-投票智能合约代码片段-如下" aria-hidden="true"></a></h3><blockquote>
<p>完整代码: <code>https://github.com/nuls-io/nuls-vote</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> io.nuls.vote.contract;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Address;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Contract;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Utils;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.Payable;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.View;</span><br><span class="line"><span class="keyword">import</span> io.nuls.vote.contract.func.BaseVote;</span><br><span class="line"><span class="keyword">import</span> io.nuls.vote.contract.func.VoteInterface;</span><br><span class="line"><span class="keyword">import</span> io.nuls.vote.contract.model.VoteConfig;</span><br><span class="line"><span class="keyword">import</span> io.nuls.vote.contract.model.VoteEntity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoteContract</span> <span class="keyword">implements</span> <span class="title">Contract</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> VoteInterface baseVote;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VoteContract</span><span class="params">(<span class="keyword">long</span> minRecognizance)</span> </span>&#123;</span><br><span class="line">        baseVote = <span class="keyword">new</span> BaseVote(BigInteger.valueOf(minRecognizance));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Payable</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> VoteEntity <span class="title">create</span><span class="params">(String title, String desc, String[] items, <span class="keyword">long</span> startTime, <span class="keyword">long</span> endTime, <span class="keyword">boolean</span> isMultipleSelect, <span class="keyword">int</span> maxSelectCount, <span class="keyword">boolean</span> voteCanModify)</span> </span>&#123;</span><br><span class="line">        VoteEntity voteEntity = baseVote.create(title, desc, items);</span><br><span class="line"></span><br><span class="line">        VoteConfig config = <span class="keyword">new</span> VoteConfig(startTime, endTime, isMultipleSelect, maxSelectCount, voteCanModify);</span><br><span class="line">        <span class="keyword">boolean</span> success = baseVote.init(voteEntity.getId(), config);</span><br><span class="line"></span><br><span class="line">        Utils.require(success);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> voteEntity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">vote</span><span class="params">(<span class="keyword">long</span> voteId, <span class="keyword">long</span>[] itemIds)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseVote.vote(voteId, itemIds);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">redemption</span><span class="params">(<span class="keyword">long</span> voteId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseVote.redemption(voteId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canVote</span><span class="params">(<span class="keyword">long</span> voteId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseVote.canVote(voteId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> VoteEntity <span class="title">queryVote</span><span class="params">(<span class="keyword">long</span> voteId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseVote.queryVote(voteId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;Address, List&lt;Long&gt;&gt; queryVoteResult(<span class="keyword">long</span> voteId) &#123;</span><br><span class="line">        <span class="keyword">return</span> baseVote.queryVoteResult(voteId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">queryAddressHasVote</span><span class="params">(<span class="keyword">long</span> voteId, Address address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseVote.queryAddressHasVote(voteId, address);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>智能合约的方法中如果有<code>数组类型</code>的参数，请使用如下方式传递参数</p>
<blockquote>
<p>参考以上投票合约代码中的<code>create</code>方法</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"sender"</span>: <span class="string">"NsdtydTVWskMc7GkZzbsq2FoChqKFwMf"</span>,</span><br><span class="line">  <span class="string">"password"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"contractAddress"</span>: <span class="string">"NseLt14NacjTDhXaTXUdrk6VF7aEwtW4"</span>,</span><br><span class="line">  <span class="string">"gasLimit"</span>: <span class="number">200000</span>,</span><br><span class="line">  <span class="string">"price"</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">"value"</span>: <span class="number">10000000000</span>,</span><br><span class="line">  <span class="string">"methodName"</span>: <span class="string">"create"</span>,</span><br><span class="line">  <span class="string">"methodDesc"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"remark"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"args"</span>: [</span><br><span class="line">    <span class="string">"测试投票1"</span>,</span><br><span class="line">    <span class="string">"第一个投票合约"</span>,</span><br><span class="line">    [</span><br><span class="line">      <span class="string">"第一个选项"</span>,</span><br><span class="line">      <span class="string">"第二个选项"</span>,</span><br><span class="line">      <span class="string">"第三个选项"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="number">1536044066056</span>, <span class="number">1536184066056</span>, <span class="literal">false</span>, <span class="number">300</span>, <span class="literal">false</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-2-Standard-Token-智能合约代码片段" class="article-heading"><a href="#7-2-Standard-Token-智能合约代码片段" class="headerlink" title="7.2 Standard Token 智能合约代码片段"></a>7.2 Standard Token 智能合约代码<code>片段</code><a class="article-anchor" href="#7-2-Standard-Token-智能合约代码片段" aria-hidden="true"></a></h3><blockquote>
<p>完整代码: <code>https://github.com/nuls-io/nuls-nrc20</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> io.nuls.contract.token;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Address;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Contract;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.Msg;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.Required;</span><br><span class="line"><span class="keyword">import</span> io.nuls.contract.sdk.annotation.View;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> io.nuls.contract.sdk.Utils.emit;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> io.nuls.contract.sdk.Utils.require;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleToken</span> <span class="keyword">implements</span> <span class="title">Contract</span>, <span class="title">Token</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String symbol;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> decimals;</span><br><span class="line">    <span class="keyword">private</span> BigInteger totalSupply = BigInteger.ZERO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Address, BigInteger&gt; balances = <span class="keyword">new</span> HashMap&lt;Address, BigInteger&gt;();</span><br><span class="line">    <span class="keyword">private</span> Map&lt;Address, Map&lt;Address, BigInteger&gt;&gt; allowed = <span class="keyword">new</span> HashMap&lt;Address, Map&lt;Address, BigInteger&gt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">symbol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> symbol;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">decimals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> decimals;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigInteger <span class="title">totalSupply</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> totalSupply;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SimpleToken</span><span class="params">(@Required String name, @Required String symbol, @Required BigInteger initialAmount, @Required <span class="keyword">int</span> decimals)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.symbol = symbol;</span><br><span class="line">        <span class="keyword">this</span>.decimals = decimals;</span><br><span class="line">        totalSupply = initialAmount.multiply(BigInteger.TEN.pow(decimals));;</span><br><span class="line">        balances.put(Msg.sender(), totalSupply);</span><br><span class="line">        emit(<span class="keyword">new</span> TransferEvent(<span class="keyword">null</span>, Msg.sender(), totalSupply));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigInteger <span class="title">allowance</span><span class="params">(@Required Address owner, @Required Address spender)</span> </span>&#123;</span><br><span class="line">        Map&lt;Address, BigInteger&gt; ownerAllowed = allowed.get(owner);</span><br><span class="line">        <span class="keyword">if</span> (ownerAllowed == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> BigInteger.ZERO;</span><br><span class="line">        &#125;</span><br><span class="line">        BigInteger value = ownerAllowed.get(spender);</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</span><br><span class="line">            value = BigInteger.ZERO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">transferFrom</span><span class="params">(@Required Address from, @Required Address to, @Required BigInteger value)</span> </span>&#123;</span><br><span class="line">        subtractAllowed(from, Msg.sender(), value);</span><br><span class="line">        subtractBalance(from, value);</span><br><span class="line">        addBalance(to, value);</span><br><span class="line">        emit(<span class="keyword">new</span> TransferEvent(from, to, value));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@View</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BigInteger <span class="title">balanceOf</span><span class="params">(@Required Address owner)</span> </span>&#123;</span><br><span class="line">        require(owner != <span class="keyword">null</span>);</span><br><span class="line">        BigInteger balance = balances.get(owner);</span><br><span class="line">        <span class="keyword">if</span> (balance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            balance = BigInteger.ZERO;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">transfer</span><span class="params">(@Required Address to, @Required BigInteger value)</span> </span>&#123;</span><br><span class="line">        subtractBalance(Msg.sender(), value);</span><br><span class="line">        addBalance(to, value);</span><br><span class="line">        emit(<span class="keyword">new</span> TransferEvent(Msg.sender(), to, value));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">approve</span><span class="params">(@Required Address spender, @Required BigInteger value)</span> </span>&#123;</span><br><span class="line">        setAllowed(Msg.sender(), spender, value);</span><br><span class="line">        emit(<span class="keyword">new</span> ApprovalEvent(Msg.sender(), spender, value));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">increaseApproval</span><span class="params">(@Required Address spender, @Required BigInteger addedValue)</span> </span>&#123;</span><br><span class="line">        addAllowed(Msg.sender(), spender, addedValue);</span><br><span class="line">        emit(<span class="keyword">new</span> ApprovalEvent(Msg.sender(), spender, allowance(Msg.sender(), spender)));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">decreaseApproval</span><span class="params">(@Required Address spender, @Required BigInteger subtractedValue)</span> </span>&#123;</span><br><span class="line">        check(subtractedValue);</span><br><span class="line">        BigInteger oldValue = allowance(Msg.sender(), spender);</span><br><span class="line">        <span class="keyword">if</span> (subtractedValue.compareTo(oldValue) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            setAllowed(Msg.sender(), spender, BigInteger.ZERO);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            subtractAllowed(Msg.sender(), spender, subtractedValue);</span><br><span class="line">        &#125;</span><br><span class="line">        emit(<span class="keyword">new</span> ApprovalEvent(Msg.sender(), spender, allowance(Msg.sender(), spender)));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addAllowed</span><span class="params">(Address address1, Address address2, BigInteger value)</span> </span>&#123;</span><br><span class="line">        BigInteger allowance = allowance(address1, address2);</span><br><span class="line">        check(allowance);</span><br><span class="line">        check(value);</span><br><span class="line">        setAllowed(address1, address2, allowance.add(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">subtractAllowed</span><span class="params">(Address address1, Address address2, BigInteger value)</span> </span>&#123;</span><br><span class="line">        BigInteger allowance = allowance(address1, address2);</span><br><span class="line">        check(allowance, value, <span class="string">"Insufficient approved token"</span>);</span><br><span class="line">        setAllowed(address1, address2, allowance.subtract(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setAllowed</span><span class="params">(Address address1, Address address2, BigInteger value)</span> </span>&#123;</span><br><span class="line">        check(value);</span><br><span class="line">        Map&lt;Address, BigInteger&gt; address1Allowed = allowed.get(address1);</span><br><span class="line">        <span class="keyword">if</span> (address1Allowed == <span class="keyword">null</span>) &#123;</span><br><span class="line">            address1Allowed = <span class="keyword">new</span> HashMap&lt;Address, BigInteger&gt;();</span><br><span class="line">            allowed.put(address1, address1Allowed);</span><br><span class="line">        &#125;</span><br><span class="line">        address1Allowed.put(address2, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addBalance</span><span class="params">(Address address, BigInteger value)</span> </span>&#123;</span><br><span class="line">        BigInteger balance = balanceOf(address);</span><br><span class="line">        check(value, <span class="string">"The value must be greater than or equal to 0."</span>);</span><br><span class="line">        check(balance);</span><br><span class="line">        balances.put(address, balance.add(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">subtractBalance</span><span class="params">(Address address, BigInteger value)</span> </span>&#123;</span><br><span class="line">        BigInteger balance = balanceOf(address);</span><br><span class="line">        check(balance, value, <span class="string">"Insufficient balance of token."</span>);</span><br><span class="line">        balances.put(address, balance.subtract(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">check</span><span class="params">(BigInteger value)</span> </span>&#123;</span><br><span class="line">        require(value != <span class="keyword">null</span> &amp;&amp; value.compareTo(BigInteger.ZERO) &gt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">check</span><span class="params">(BigInteger value1, BigInteger value2)</span> </span>&#123;</span><br><span class="line">        check(value1);</span><br><span class="line">        check(value2);</span><br><span class="line">        require(value1.compareTo(value2) &gt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">check</span><span class="params">(BigInteger value, String msg)</span> </span>&#123;</span><br><span class="line">        require(value != <span class="keyword">null</span> &amp;&amp; value.compareTo(BigInteger.ZERO) &gt;= <span class="number">0</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">check</span><span class="params">(BigInteger value1, BigInteger value2, String msg)</span> </span>&#123;</span><br><span class="line">        check(value1);</span><br><span class="line">        check(value2);</span><br><span class="line">        require(value1.compareTo(value2) &gt;= <span class="number">0</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-01-02T05:45:52.004Z" itemprop="dateModified">上次更新：2019-01-02</time>
                <a href="NRC-20_Token_Standard.html" class="article-footer-next" title="NRC-20"><span>下一页</span><i class="fa fa-chevron-right"></i></a>
              </footer>
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">目录</strong>
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NULS智能合约开发手册"><span class="toc-text">NULS智能合约开发手册</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-简介"><span class="toc-text">1. 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-开发环境"><span class="toc-text">2. 开发环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-安装NULS钱包"><span class="toc-text">2.1 安装NULS钱包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-安装JDK-8"><span class="toc-text">2.2 安装JDK 8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-安装IntelliJ-IDEA"><span class="toc-text">2.3 安装IntelliJ IDEA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-安装NULS智能合约插件"><span class="toc-text">2.4 安装NULS智能合约插件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-NULS智能合约规范与语法"><span class="toc-text">3. NULS智能合约规范与语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-NULS智能合约规范"><span class="toc-text">3.1 NULS智能合约规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-关键字"><span class="toc-text">3.2 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-基本语法"><span class="toc-text">3.3 基本语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-支持的类"><span class="toc-text">3.4 支持的类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-其他限制"><span class="toc-text">3.5 其他限制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-NULS智能合约简单示例"><span class="toc-text">4. NULS智能合约简单示例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-NULS-Contract-SDK"><span class="toc-text">5. NULS Contract SDK</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-Address"><span class="toc-text">io.nuls.contract.sdk.Address</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-Block"><span class="toc-text">io.nuls.contract.sdk.Block</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-BlockHeader"><span class="toc-text">io.nuls.contract.sdk.BlockHeader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-Contract"><span class="toc-text">io.nuls.contract.sdk.Contract</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-Event"><span class="toc-text">io.nuls.contract.sdk.Event</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-Msg"><span class="toc-text">io.nuls.contract.sdk.Msg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-Utils"><span class="toc-text">io.nuls.contract.sdk.Utils</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-annotation-Payable"><span class="toc-text">io.nuls.contract.sdk.annotation.Payable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-annotation-Required"><span class="toc-text">io.nuls.contract.sdk.annotation.Required</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#io-nuls-contract-sdk-annotation-View"><span class="toc-text">io.nuls.contract.sdk.annotation.View</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-智能合约主要的RPC接口"><span class="toc-text">6. 智能合约主要的RPC接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-创建智能合约"><span class="toc-text">6.1 创建智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-估算创建智能合约的Gas消耗"><span class="toc-text">6.2 估算创建智能合约的Gas消耗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-调用智能合约"><span class="toc-text">6.3 调用智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-估算调用智能合约的Gas消耗-参见Swagger-UI"><span class="toc-text">6.4 估算调用智能合约的Gas消耗(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-估算智能合约的price-参见Swagger-UI"><span class="toc-text">6.5 估算智能合约的price(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-终止智能合约-参见Swagger-UI"><span class="toc-text">6.6 终止智能合约(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-7-调用不上链的智能合约函数-参见Swagger-UI"><span class="toc-text">6.7 调用不上链的智能合约函数(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-8-获取智能合约执行结果-参见Swagger-UI"><span class="toc-text">6.8 获取智能合约执行结果(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-9-获取智能合约基本信息-参见Swagger-UI"><span class="toc-text">6.9 获取智能合约基本信息(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-10-验证是否为合约地址-参见Swagger-UI"><span class="toc-text">6.10 验证是否为合约地址(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-11-获取智能合约地址的NULS余额-参见Swagger-UI"><span class="toc-text">6.11 获取智能合约地址的NULS余额(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-12-获取智能合约交易详情-参见Swagger-UI"><span class="toc-text">6.12 获取智能合约交易详情(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-13-获取智能合约的交易列表-参见Swagger-UI"><span class="toc-text">6.13 获取智能合约的交易列表(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-14-根据address和limit查询合约UTXO-参见Swagger-UI"><span class="toc-text">6.14 根据address和limit查询合约UTXO(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-15-根据address和amount查询合约UTXO-参见Swagger-UI"><span class="toc-text">6.15 根据address和amount查询合约UTXO(参见Swagger UI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-16-向智能合约转账-参见Swagger-UI"><span class="toc-text">6.16 向智能合约转账(参见Swagger UI)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-示例"><span class="toc-text">7. 示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-投票智能合约代码片段-如下"><span class="toc-text">7.1 投票智能合约代码片段, 如下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-Standard-Token-智能合约代码片段"><span class="toc-text">7.2 Standard Token 智能合约代码片段</span></a></li></ol></li></ol></li></ol>
              <a href="#" id="article-toc-top">回到顶部</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">Get Started</strong><a href="index.html" class="sidebar-link current">开发者手册</a><a href="NRC-20_Token_Standard.html" class="sidebar-link">NRC-20</a><a href="IdeaPlugin.html" class="sidebar-link">IDEA插件操作手册</a><a href="CommunityVote.html" class="sidebar-link">社区投票指南</a><a href="smartContract.html" class="sidebar-link">钱包智能合约操作手册</a><a href="SmartContractFee.html" class="sidebar-link">智能合约手续费</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <div class="footer-index" id="footer">
   <div class="footer-index-inner">
      <div class="footer-left">
         <div>© 2018 <a href="https://nuls.io" target="_blank">Nuls</a></div>
         <div>Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a></div>
         <div>Power by <a href="https://hexo.io" target="_blank">HEXO</a></div>
      </div>
      <div class="footer-middle">
        <div>
          <a href="https://twitter.com/nulsservice" target="_blank"><i class="footer-icon1"></i></a>
        </div>
        <div>
         <a href="https://www.reddit.com/r/nulsservice/" target="_blank"><i class="footer-icon2"></i></a>
        </div>
        <div>
          <a href="https://t.me/Nulsio" target="_blank"><i class="footer-icon3"></i></a>
        </div>
        <div>
           <a href="https://steemit.com/@nuls" target="_blank"><i class="footer-icon4"></i></a>
        </div>
        <div>
          <a href="https://github.com/nuls-io/nuls" target="_blank"><i class="footer-icon5"></i></a>
        </div>
        <div>
          <a href="https://www.facebook.com/nulscommunity/" target="_blank"><i class="footer-icon6"></i></a>
        </div>
        <div>
          <a href="https://join.slack.com/t/nuls/shared_invite/enQtMjQ4MTM4ODAyNTI4LWJjNGMwYTE0YjRlYmFlZGUwM2JhOGE4MDIwZmE4MzA2MDg1YzUyMmVkN2RhZjkyNWMzZjY5ZDU5ZmViMjZjNGQ" target="_blank"><i class="footer-icon7"></i></a>
        </div>
        <div>
          <a href="https://gitter.im/nuls_io" target="_blank"><i class="footer-icon8"></i></a>
        </div>
      </div>
   </div>
</div>
  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/zh-cn/docs/" class="mobile-nav-link">文档</a><a href="/zh-cn/protocol/" class="mobile-nav-link">协议</a><a href="/zh-cn/contract/" class="mobile-nav-link">智能合约</a><a href="/zh-cn/chain/" class="mobile-nav-link">跨链</a><a href="/zh-cn/manual/" class="mobile-nav-link">参考手册</a><a href="/news/" class="mobile-nav-link">新闻</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/nuls-io/nuls" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Get Started</strong><a href="index.html" class="mobile-nav-link current">开发者手册</a><a href="NRC-20_Token_Standard.html" class="mobile-nav-link">NRC-20</a><a href="IdeaPlugin.html" class="mobile-nav-link">IDEA插件操作手册</a><a href="CommunityVote.html" class="mobile-nav-link">社区投票指南</a><a href="smartContract.html" class="mobile-nav-link">钱包智能合约操作手册</a><a href="SmartContractFee.html" class="mobile-nav-link">智能合约手续费</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></span>
    <select id="mobile-lang-select" data-canonical="contract/index.html">
      
        <option value="en">English</option>
      
        <option value="zh-cn" selected>简体中文</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<script src="/js/common.js"></script>
<!-- endbuild -->

</body>
</html>