<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>NULS</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://nuls-io.github.io/manual/index.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://nuls-io.github.io/manual/index.html">
    
      <link rel="alternative" hreflang="zh-cn" href="https://nuls-io.github.io/zh-cn/manual/index.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <meta name="generator" content="Hexo 3.8.0">
  <!-- CSS -->
  <!-- build:css build/css/nuls.css -->
  <link rel="stylesheet" href="/css/nuls.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="NULS">
</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="/docs/" class="main-nav-link">Documents</a><a href="/protocol/" class="main-nav-link">Protocol</a><a href="/contract/" class="main-nav-link">Smart Contract</a><a href="/chain/" class="main-nav-link">Cross-Chain</a><a href="/manual/" class="main-nav-link">Manual</a><a href="/news/" class="main-nav-link">News</a>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>English</span></label>
      <select id="lang-select" data-canonical="manual/index.html">
        
          <option value="en" selected>English</option>
        
          <option value="zh-cn">简体中文</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope="" itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name"></h1>
                <a href="https://github.com/nuls-io/devsite/edit/master/source/manual/index.md" class="article-edit-link" title="Improve this doc"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h1 id="Unit-2-Overall-Design" class="article-heading"><a href="#Unit-2-Overall-Design" class="headerlink" title="Unit 2 Overall Design"></a>Unit 2 Overall Design<a class="article-anchor" href="#Unit-2-Overall-Design" aria-hidden="true"></a></h1><h2 id="1、Architecture-diagram" class="article-heading"><a href="#1、Architecture-diagram" class="headerlink" title="1、Architecture diagram"></a>1、Architecture diagram<a class="article-anchor" href="#1、Architecture-diagram" aria-hidden="true"></a></h2><p><img src="./index/structure.png" alt="总体架构图"></p>
<h3 id="1-1-Storage-and-tool-layer" class="article-heading"><a href="#1-1-Storage-and-tool-layer" class="headerlink" title="1.1 Storage and tool layer"></a>1.1 Storage and tool layer<a class="article-anchor" href="#1-1-Storage-and-tool-layer" aria-hidden="true"></a></h3><h4 id="1-1-1-Tools" class="article-heading"><a href="#1-1-1-Tools" class="headerlink" title="1.1.1 Tools"></a>1.1.1 Tools<a class="article-anchor" href="#1-1-1-Tools" aria-hidden="true"></a></h4><p>​     The NULS low-level code separates the tools-module module and provides various underlying related tool codes, including cryptography tools, http tools, caching tools, math calculation tools, configuration file operation tools, command line tools, etc., which are convenient for upper-level modules. </p>
<h4 id="1-1-2-Storage-layer" class="article-heading"><a href="#1-1-2-Storage-layer" class="headerlink" title="1.1.2 Storage layer"></a>1.1.2 Storage layer<a class="article-anchor" href="#1-1-2-Storage-layer" aria-hidden="true"></a></h4><p>​     The db-module module defines the interface of the data storage service for storing various types of data. The currently implemented version is based on LevelDB for key-value type storage, and can store any serialized data in the database, which is efficient and space-saving. </p>
<h3 id="1-2-Network-layer" class="article-heading"><a href="#1-2-Network-layer" class="headerlink" title="1.2 Network layer"></a>1.2 Network layer<a class="article-anchor" href="#1-2-Network-layer" aria-hidden="true"></a></h3><p>​    The network-module module defines the interface of the network service for establishing connections and communicating with peer nodes. The currently implemented version is based on the Netty implementation and defines a set of communication protocols for managing nodes and connections. Module functions include node discovery, data transfer, timed handshake, node management, etc.</p>
<h3 id="1-3-Consensus-layer" class="article-heading"><a href="#1-3-Consensus-layer" class="headerlink" title="1.3 Consensus layer"></a>1.3 Consensus layer<a class="article-anchor" href="#1-3-Consensus-layer" aria-hidden="true"></a></h3><p>​    The consensus layer defines tokens, incentive mechanisms, block packing mechanisms, basic data protocols, and core business processes. The current implementation uses POC consensus implementation.</p>
<h3 id="1-4-Interface-layer" class="article-heading"><a href="#1-4-Interface-layer" class="headerlink" title="1.4 Interface layer"></a>1.4 Interface layer<a class="article-anchor" href="#1-4-Interface-layer" aria-hidden="true"></a></h3><p>​    The interface layer of NULS is divided into two parts, the smart contract and the RPC interface service. The smart contract is based on NVM and supports Java syntax. RPC is implemented by various functional modules. Each module can provide its own RPC interface. All RPC interfaces are aggregated to form the NULS RPC interface service.</p>
<h3 id="1-5-Application-layer" class="article-heading"><a href="#1-5-Application-layer" class="headerlink" title="1.5 Application layer"></a>1.5 Application layer<a class="article-anchor" href="#1-5-Application-layer" aria-hidden="true"></a></h3><p>​    Business applications in the NULS ecosystem.</p>
<h2 id="2、-Relationship-between-modules" class="article-heading"><a href="#2、-Relationship-between-modules" class="headerlink" title="2、 Relationship between modules"></a>2、 Relationship between modules<a class="article-anchor" href="#2、-Relationship-between-modules" aria-hidden="true"></a></h2><p><img src="./index/relationship.png" alt="relationship"></p>
<p><img src="./index/relationship2.png" alt="模块关系">    </p>
<h3 id="2-1-Tools-module" class="article-heading"><a href="#2-1-Tools-module" class="headerlink" title="2.1 Tools module"></a>2.1 Tools module<a class="article-anchor" href="#2-1-Tools-module" aria-hidden="true"></a></h3><p>​    Tool module with some basic tools built in for other modules.</p>
<h3 id="2-2-Core-module" class="article-heading"><a href="#2-2-Core-module" class="headerlink" title="2.2 Core module"></a>2.2 Core module<a class="article-anchor" href="#2-2-Core-module" aria-hidden="true"></a></h3><p>​    The microkernel module is responsible for module management, thread management, context management, and configuration information management.</p>
<h3 id="2-3-Account-module" class="article-heading"><a href="#2-3-Account-module" class="headerlink" title="2.3 Account module"></a>2.3 Account module<a class="article-anchor" href="#2-3-Account-module" aria-hidden="true"></a></h3><p>​    The account module is responsible for the management of addresses, public and private key pairs, and account token balances.</p>
<h3 id="2-4-Network-module" class="article-heading"><a href="#2-4-Network-module" class="headerlink" title="2.4 Network module"></a>2.4 Network module<a class="article-anchor" href="#2-4-Network-module" aria-hidden="true"></a></h3><p>​    The network module is responsible for receiving and transmitting messages between peer nodes, where the service messages are sent to the message-bus module by means of interface calls.</p>
<h3 id="2-5-Message-Bus-module" class="article-heading"><a href="#2-5-Message-Bus-module" class="headerlink" title="2.5 Message-Bus module"></a>2.5 Message-Bus module<a class="article-anchor" href="#2-5-Message-Bus-module" aria-hidden="true"></a></h3><p>​    The module currently implements the use of the Disruptor circular queue to buffer data and distribute the messages to the corresponding Handlers.</p>
<h3 id="2-6-Protocol-module" class="article-heading"><a href="#2-6-Protocol-module" class="headerlink" title="2.6 Protocol module"></a>2.6 Protocol module<a class="article-anchor" href="#2-6-Protocol-module" aria-hidden="true"></a></h3><p>​    The currently implemented Protocol module defines the protocol for most common services and implements most of the protocol’s processors, including block processing, transaction processing, data synchronization, and so on.</p>
<h3 id="2-7-consensus-module" class="article-heading"><a href="#2-7-consensus-module" class="headerlink" title="2.7 consensus module"></a>2.7 consensus module<a class="article-anchor" href="#2-7-consensus-module" aria-hidden="true"></a></h3><p>​    The consensus module is responsible for token creation, management, packaging, data validation, data storage, business logic management for block packaging, and node penalties.</p>
<h3 id="2-8-Ledger-module" class="article-heading"><a href="#2-8-Ledger-module" class="headerlink" title="2.8 Ledger module"></a>2.8 Ledger module<a class="article-anchor" href="#2-8-Ledger-module" aria-hidden="true"></a></h3><p>​    This module is responsible for storing token data records in transactions and transactions, and verifying that token usage is legal.</p>
<h3 id="2-9-Storage-module" class="article-heading"><a href="#2-9-Storage-module" class="headerlink" title="2.9 Storage module"></a>2.9 Storage module<a class="article-anchor" href="#2-9-Storage-module" aria-hidden="true"></a></h3><p>​    The db-module storage module supports all types of data storage and is currently stored in LevelDB.</p>
<h3 id="2-10-Contract-module" class="article-heading"><a href="#2-10-Contract-module" class="headerlink" title="2.10 Contract module"></a>2.10 Contract module<a class="article-anchor" href="#2-10-Contract-module" aria-hidden="true"></a></h3><p>​    The contract module is mainly used for communication with NVM (NULS virtual machine), which can perform call and query operations of smart contract related services.</p>
<p>More detailed module introduction see subsequent chapters</p>
<h2 id="3、Core-business-relationship" class="article-heading"><a href="#3、Core-business-relationship" class="headerlink" title="3、Core business relationship"></a>3、Core business relationship<a class="article-anchor" href="#3、Core-business-relationship" aria-hidden="true"></a></h2><p><img src="./index/blockchain.png" alt="区块链"></p>
<ul>
<li>Description:<ul>
<li>After the system is started, the node discovery function is used to find and connect the peer nodes to realize communication between nodes.</li>
<li>The received external message is uniformly processed into the ConnectionManager. If it is the message of the network module itself, it is put into the network message processor. Otherwise, it is uniformly distributed through the Message-Bus and sent to the processor corresponding to the message for processing.</li>
<li>Messages are divided into 3 types, blocks, transactions and other business messages, which are handled differently</li>
<li>The transaction is placed in the buffer pool and then verified for packaging by the consensus module</li>
<li>Store directly after block verification</li>
<li>Other business messages are processed in the handler and the network is returned to return the processing result</li>
<li>The application implements data interaction by calling RPC. It can broadcast a transaction like a network, or obtain the required data from the received block.</li>
<li>When each module calls the storage module, the service data will be prepared. The storage module is only responsible for adding, deleting, and changing operations, and does not perform any business processing.</li>
</ul>
</li>
</ul>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-01-02T05:45:51.928Z" itemprop="dateModified">Last updated: 2019-01-02</time>
                <a href="modularity.html" class="article-footer-next" title="Modularity"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Unit-2-Overall-Design"><span class="toc-text">Unit 2 Overall Design</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、Architecture-diagram"><span class="toc-text">1、Architecture diagram</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Storage-and-tool-layer"><span class="toc-text">1.1 Storage and tool layer</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-Tools"><span class="toc-text">1.1.1 Tools</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-Storage-layer"><span class="toc-text">1.1.2 Storage layer</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Network-layer"><span class="toc-text">1.2 Network layer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-Consensus-layer"><span class="toc-text">1.3 Consensus layer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-Interface-layer"><span class="toc-text">1.4 Interface layer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-Application-layer"><span class="toc-text">1.5 Application layer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、-Relationship-between-modules"><span class="toc-text">2、 Relationship between modules</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Tools-module"><span class="toc-text">2.1 Tools module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Core-module"><span class="toc-text">2.2 Core module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Account-module"><span class="toc-text">2.3 Account module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Network-module"><span class="toc-text">2.4 Network module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-Message-Bus-module"><span class="toc-text">2.5 Message-Bus module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-Protocol-module"><span class="toc-text">2.6 Protocol module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-consensus-module"><span class="toc-text">2.7 consensus module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-8-Ledger-module"><span class="toc-text">2.8 Ledger module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-9-Storage-module"><span class="toc-text">2.9 Storage module</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-Contract-module"><span class="toc-text">2.10 Contract module</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、Core-business-relationship"><span class="toc-text">3、Core business relationship</span></a></li></ol></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">Getting Started</strong><a href="index.html" class="sidebar-link current">Architecture</a><a href="modularity.html" class="sidebar-link">Modularity</a><a href="structure.html" class="sidebar-link">Structure</a><a href="modular_overview.html" class="sidebar-link">Modular Overview</a><a href="micro_kernel.html" class="sidebar-link">Micro Kernel</a><a href="message_bus.html" class="sidebar-link">Message Bus</a><strong class="sidebar-title">Module Overview</strong><a href="network_overview.html" class="sidebar-link">Network</a><a href="storage.html" class="sidebar-link">Storage</a><a href="account.html" class="sidebar-link">Account</a><a href="ledger.html" class="sidebar-link">Ledger</a><a href="protocol.html" class="sidebar-link">Protocol</a><a href="consensus.html" class="sidebar-link">Consensus</a><a href="contract.html" class="sidebar-link">Smart Contract</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <div class="footer-index" id="footer">
   <div class="footer-index-inner">
      <div class="footer-left">
         <div>© 2018 <a href="https://nuls.io" target="_blank">Nuls</a></div>
         <div>Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a></div>
         <div>Power by <a href="https://hexo.io" target="_blank">HEXO</a></div>
      </div>
      <div class="footer-middle">
        <div>
          <a href="https://twitter.com/nulsservice" target="_blank"><i class="footer-icon1"></i></a>
        </div>
        <div>
         <a href="https://www.reddit.com/r/nulsservice/" target="_blank"><i class="footer-icon2"></i></a>
        </div>
        <div>
          <a href="https://t.me/Nulsio" target="_blank"><i class="footer-icon3"></i></a>
        </div>
        <div>
           <a href="https://steemit.com/@nuls" target="_blank"><i class="footer-icon4"></i></a>
        </div>
        <div>
          <a href="https://github.com/nuls-io/nuls" target="_blank"><i class="footer-icon5"></i></a>
        </div>
        <div>
          <a href="https://www.facebook.com/nulscommunity/" target="_blank"><i class="footer-icon6"></i></a>
        </div>
        <div>
          <a href="https://join.slack.com/t/nuls/shared_invite/enQtMjQ4MTM4ODAyNTI4LWJjNGMwYTE0YjRlYmFlZGUwM2JhOGE4MDIwZmE4MzA2MDg1YzUyMmVkN2RhZjkyNWMzZjY5ZDU5ZmViMjZjNGQ" target="_blank"><i class="footer-icon7"></i></a>
        </div>
        <div>
          <a href="https://gitter.im/nuls_io" target="_blank"><i class="footer-icon8"></i></a>
        </div>
      </div>
   </div>
</div>
  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/docs/" class="mobile-nav-link">Documents</a><a href="/protocol/" class="mobile-nav-link">Protocol</a><a href="/contract/" class="mobile-nav-link">Smart Contract</a><a href="/chain/" class="mobile-nav-link">Cross-Chain</a><a href="/manual/" class="mobile-nav-link">Manual</a><a href="/news/" class="mobile-nav-link">News</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/nuls-io/nuls" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Getting Started</strong><a href="index.html" class="mobile-nav-link current">Architecture</a><a href="modularity.html" class="mobile-nav-link">Modularity</a><a href="structure.html" class="mobile-nav-link">Structure</a><a href="modular_overview.html" class="mobile-nav-link">Modular Overview</a><a href="micro_kernel.html" class="mobile-nav-link">Micro Kernel</a><a href="message_bus.html" class="mobile-nav-link">Message Bus</a><strong class="mobile-nav-title">Module Overview</strong><a href="network_overview.html" class="mobile-nav-link">Network</a><a href="storage.html" class="mobile-nav-link">Storage</a><a href="account.html" class="mobile-nav-link">Account</a><a href="ledger.html" class="mobile-nav-link">Ledger</a><a href="protocol.html" class="mobile-nav-link">Protocol</a><a href="consensus.html" class="mobile-nav-link">Consensus</a><a href="contract.html" class="mobile-nav-link">Smart Contract</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="manual/index.html">
      
        <option value="en" selected>English</option>
      
        <option value="zh-cn">简体中文</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<script src="/js/common.js"></script>
<!-- endbuild -->

</body>
</html>